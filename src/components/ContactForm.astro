<div
  id='contacto'
  class='relative isolate bg-petrol-50 px-6 py-12 sm:py-16 lg:px-8'>
  <svg
    aria-hidden='true'
    class='absolute inset-0 -z-10 size-full mask-[radial-gradient(100%_100%_at_top_right,white,transparent)] stroke-gray-200'>
    <defs>
      <pattern
        id='83fd4e5a-9d52-42fc-97b6-718e5d7ee527'
        width='200'
        height='200'
        x='50%'
        y='-64'
        patternUnits='userSpaceOnUse'>
        <path
          d='M100 200V.5M.5 .5H200'
          fill='none'
        ></path>
      </pattern>
    </defs>
    <svg
      x='50%'
      y='-64'
      class='overflow-visible fill-gray-50'>
      <path
        d='M-100.5 0h201v201h-201Z M699.5 0h201v201h-201Z M499.5 400h201v201h-201Z M299.5 800h201v201h-201Z'
        stroke-width='0'
      ></path>
    </svg>
    <rect
      width='100%'
      height='100%'
      fill='url(#83fd4e5a-9d52-42fc-97b6-718e5d7ee527)'
      stroke-width='0'
    ></rect>
  </svg>
  <div class='mx-auto max-w-7xl'>
    <div class='grid grid-cols-1 gap-x-15 gap-y-10 lg:grid-cols-[2fr_2fr]'>
      <!-- Left Column: Form -->
      <div>
        <h2
          class='text-3xl font-semibold tracking-tight text-pretty text-petrol-900 sm:text-4xl'>
          Entonces hablemos
        </h2>
        <p class='mt-2 text-lg/8 text-petrol-900'>
          Cuentame tu situación y qué te gustaría conseguir. Solo una
          conversación para evaluar si tiene sentido trabajar juntos.
        </p>
        <form
          id='contact-form'
          class='mt-8'>
          <div class='grid grid-cols-1 gap-x-6 gap-y-4'>
            <div>
              <label
                for='name'
                class='block text-sm/6 font-semibold text-petrol-900'
                >Nombre (opcional)</label
              >
              <div class='mt-1.5'>
                <input
                  id='name'
                  type='text'
                  name='name'
                  autocomplete='name'
                  placeholder='Cómo te llamas'
                  class='block w-full rounded-md bg-white px-3 py-1.5 text-base text-petrol-900 outline-1 -outline-offset-1 outline-gray-300 backdrop-blur-sm placeholder:text-gray-400 focus:outline-2 focus:-outline-offset-2 focus:outline-sky-500'
                />
              </div>
            </div>
            <div>
              <label
                for='email'
                class='block text-sm/6 font-semibold text-petrol-900'
                >Email *</label
              >
              <div class='mt-1.5'>
                <input
                  id='email'
                  type='email'
                  name='email'
                  autocomplete='email'
                  required
                  placeholder='tu@email.com'
                  class='block w-full rounded-md bg-white px-3 py-1.5 text-base text-petrol-900 outline-1 -outline-offset-1 outline-gray-300 backdrop-blur-sm placeholder:text-gray-400 focus:outline-2 focus:-outline-offset-2 focus:outline-sky-500'
                />
              </div>
            </div>
            <div>
              <label
                for='message'
                class='block text-sm/6 font-semibold text-petrol-900'
                >Mensaje *</label
              >
              <div class='mt-1.5'>
                <textarea
                  id='message'
                  name='message'
                  rows='4'
                  required
                  placeholder='Tu negocio, tu zona, qué te preocupa…'
                  class='block w-full rounded-md bg-white px-3 py-1.5 text-base text-petrol-900 outline-1 -outline-offset-1 outline-gray-300 backdrop-blur-sm placeholder:text-gray-400 focus:outline-2 focus:-outline-offset-2 focus:outline-sky-500'
                ></textarea>
              </div>
            </div>
          </div>
          <div class='flex items-start gap-2 text-sm mt-4'>
            <input
              type='checkbox'
              id='contact-privacy-consent'
              name='privacyConsent'
              required
              class='mt-0.5'
            />
            <label
              for='contact-privacy-consent'
              class='text-petrol-900'>
              He leído y acepto la
              <a
                href='/politica-privacidad'
                class='text-orange-500 underline'>
                política de privacidad
              </a>
            </label>
          </div>
          <div class='mt-6'>
            <button
              type='submit'
              id='submit-btn'
              class='block w-full rounded-md bg-sky-500 px-3.5 py-2.5 text-center text-sm font-semibold text-white shadow-xs hover:bg-sky-600 focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-sky-500 disabled:opacity-50 disabled:cursor-not-allowed'
              >Hablemos de tu negocio</button
            >
          </div>
          <div
            id='form-message'
            class='mt-4 hidden'>
            <p class='text-sm'></p>
          </div>
        </form>
      </div>

      <!-- Right Column: Trust Signals -->
      <div class='lg:pt-20'>
        <div class='space-y-8'>
          <!-- Response Time -->
          <div class='flex gap-x-4'>
            <div class='flex-shrink-0'>
              <div
                class='flex size-10 items-center justify-center rounded-lg bg-sky-500'>
                <svg
                  xmlns='http://www.w3.org/2000/svg'
                  fill='none'
                  viewBox='0 0 24 24'
                  stroke-width='1.5'
                  stroke='currentColor'
                  class='size-6 text-white'>
                  <path
                    stroke-linecap='round'
                    stroke-linejoin='round'
                    d='M12 6v6h4.5m4.5 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z'
                  ></path>
                </svg>
              </div>
            </div>
            <div>
              <h3 class='text-base font-semibold text-petrol-900'>
                Respuesta en 24h
              </h3>
              <p class='mt-1 text-sm text-petrol-900 max-w-md'>
                Leo todos los mensajes personalmente.
              </p>
            </div>
          </div>

          <!-- Contact Alternative -->
          <div class='flex gap-x-4'>
            <div class='flex-shrink-0'>
              <div
                class='flex size-10 items-center justify-center rounded-lg bg-sky-500'>
                <svg
                  xmlns='http://www.w3.org/2000/svg'
                  fill='none'
                  viewBox='0 0 24 24'
                  stroke-width='1.5'
                  stroke='currentColor'
                  class='size-6 text-white'>
                  <path
                    stroke-linecap='round'
                    stroke-linejoin='round'
                    d='M2.25 6.75c0 8.284 6.716 15 15 15h2.25a2.25 2.25 0 0 0 2.25-2.25v-1.372c0-.516-.351-.966-.852-1.091l-4.423-1.106c-.44-.11-.902.055-1.173.417l-.97 1.293c-.282.376-.769.542-1.21.38a12.035 12.035 0 0 1-7.143-7.143c-.162-.441.004-.928.38-1.21l1.293-.97c.363-.271.527-.734.417-1.173L6.963 3.102a1.125 1.125 0 0 0-1.091-.852H4.5A2.25 2.25 0 0 0 2.25 4.5v2.25Z'
                  ></path>
                </svg>
              </div>
            </div>
            <div>
              <h3 class='text-base font-semibold text-petrol-900'>
                ¿Prefieres llamar o Whatsapp?
              </h3>
              <p class='mt-1 text-sm text-petrol-900 max-w-md'>
                <a
                  href='tel:+34692051399'
                  class='font-semibold text-sky-500 hover:text-sky-600'>
                  +34 692 051 399
                </a>
              </p>
            </div>
          </div>

          <!-- Location -->
          <div class='flex gap-x-4'>
            <div class='flex-shrink-0'>
              <div
                class='flex size-10 items-center justify-center rounded-lg bg-sky-500'>
                <svg
                  xmlns='http://www.w3.org/2000/svg'
                  fill='none'
                  viewBox='0 0 24 24'
                  stroke-width='1.5'
                  stroke='currentColor'
                  class='size-6 text-white'>
                  <path
                    stroke-linecap='round'
                    stroke-linejoin='round'
                    d='M15 10.5a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z'
                  ></path>
                  <path
                    stroke-linecap='round'
                    stroke-linejoin='round'
                    d='M19.5 10.5c0 7.142-7.5 11.25-7.5 11.25S4.5 17.642 4.5 10.5a7.5 7.5 0 1 1 15 0Z'
                  ></path>
                </svg>
              </div>
            </div>
            <div>
              <h3 class='text-base font-semibold text-petrol-900'>
                Barcelona y alrededores
              </h3>
              <p class='mt-1 text-sm text-petrol-900 max-w-md'>
                Trabajo principalmente en el área metropolitana.
              </p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
  const form = document.getElementById('contact-form') as HTMLFormElement
  const submitBtn = document.getElementById('submit-btn') as HTMLButtonElement
  const messageDiv = document.getElementById('form-message') as HTMLDivElement
  const messageP = messageDiv.querySelector('p') as HTMLParagraphElement

  form.addEventListener('submit', async e => {
    e.preventDefault()

    submitBtn.disabled = true
    submitBtn.textContent = 'Enviando...'
    messageDiv.classList.add('hidden')

    try {
      const formData = new FormData(form)
      const response = await fetch('/api/send-email', {
        method: 'POST',
        body: formData
      })

      const result = await response.json()

      if (!response.ok) {
        throw new Error(result.error || 'Error al enviar el mensaje')
      }

      messageP.textContent =
        '¡Mensaje enviado correctamente! Te responderé pronto.'
      messageP.className = 'text-sm text-green-600'
      form.reset()
    } catch (error) {
      messageP.textContent =
        error instanceof Error ?
          error.message
        : 'Error al enviar el mensaje. Inténtalo de nuevo.'
      messageP.className = 'text-sm text-red-600'
    }

    submitBtn.disabled = false
    submitBtn.textContent = 'Hablemos de tu negocio'
    messageDiv.classList.remove('hidden')
  })
</script>
